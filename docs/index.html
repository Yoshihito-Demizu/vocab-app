<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>èªå½™ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#0b1020">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- iOS -->
  <link rel="apple-touch-icon" href="./icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <style>
    :root{
      --bg:#0b1020;
      --ink:#eaf0ff;
      --muted:#b8c3e6;
      --accent:#ff3b30;
      --ok:#00d38a;
      --ng:#ff4d7d;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--ink);
    }
    .hidden{ display:none !important; }
    .wrap{ max-width:900px; margin:0 auto; padding:10px; }

    /* START */
    #startPane{
      min-height:100vh;
      background:
        linear-gradient(rgba(0,0,0,.40), rgba(0,0,0,.55)),
        url("./icons/start-bg.jpg") center/cover no-repeat;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
    }
    .startCard{
      width:min(520px, 100%);
      background: rgba(11,16,32,.72);
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
      padding:18px;
      backdrop-filter: blur(8px);
      box-shadow: 0 18px 50px rgba(0,0,0,.35);
      text-align:center;
    }
    .title{ font-size:28px; font-weight:900; margin:6px 0 8px; }
    .sub{ color:var(--muted); font-size:13px; margin:0 0 12px; line-height:1.5; }
    .btn{
      border:none; border-radius:999px;
      padding:14px 22px;
      font-weight:900; font-size:18px;
      cursor:pointer; color:#fff;
      background: var(--accent);
      box-shadow: 0 12px 30px rgba(255,59,48,.25);
    }
    .btn:active{ transform:scale(.98); }
    .btn2{
      border:none; border-radius:12px;
      padding:10px 14px;
      font-weight:800;
      cursor:pointer;
      background: rgba(255,255,255,.10);
      color: var(--ink);
    }
    .btn2:active{ transform:scale(.99); }

    /* BATTLE */
    .hud{ display:flex; gap:10px; flex-wrap:wrap; margin:10px 0 8px; }
    .stat{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:10px 12px;
      font-weight:800;
    }
    .stat b{ font-size:18px; }
    #q{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:16px;
      padding:14px;
      margin-top:8px;
    }
    #q h3{ margin:0 0 6px; font-size:22px; }
    .prompt{ color:var(--muted); font-size:13px; }

    /* choices 2x2 */
    #choices{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    #choices button{
      border:none;
      border-radius:16px;
      padding:16px 12px;
      min-height:78px;
      font-size:16px;
      font-weight:900;
      color: var(--ink);
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
      cursor:pointer;
      text-align:left;
      line-height:1.2;
    }
    #choices button:active{ transform:scale(.98); }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:10px; }

    /* RESULT */
    .resultCard{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:14px;
      box-shadow: 0 18px 50px rgba(0,0,0,.25);
    }
    .resultBig{ text-align:center; font-size:28px; font-weight:900; margin:6px 0 8px; }
    .resultLine{ text-align:center; color:var(--muted); margin:6px 0; font-weight:800; }
    .resultLine b{ color:var(--ink); font-size:22px; }
    .card{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:12px;
      margin-top:10px;
    }
    .muted{ color:var(--muted); font-size:12px; }
    select{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: var(--ink);
      font-weight:800;
      min-width:160px;
      outline:none;
    }

    /* OVERLAY */
    #overlay{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.35);
      z-index:9999;
    }
    #overlay .panel{
      width:min(520px, 92vw);
      text-align:center;
      font-weight:1000;
      border-radius:22px;
      padding:24px 18px;
      background: rgba(10,16,36,.82);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: 0 28px 80px rgba(0,0,0,.45);
      text-shadow: 0 14px 40px rgba(0,0,0,.55);
      font-size:78px;
      line-height:1;
      transform: translateY(-6px);
    }
    #overlay .panel.count{ animation: pop .18s ease-out; }
    #overlay .panel.go{ color: var(--ok); animation: pop .18s ease-out; }
    #overlay .panel.ok{ color: var(--ok); font-size:90px; animation: pop .14s ease-out; }
    #overlay .panel.ng{ color: var(--ng); font-size:90px; animation: shake .28s ease-in-out; }
    @keyframes pop{
      from{ transform: translateY(-6px) scale(.92); opacity:.3; }
      to{ transform: translateY(-6px) scale(1); opacity:1; }
    }
    @keyframes shake{
      0%,100%{ transform: translateY(-6px) translateX(0); }
      25%{ transform: translateY(-6px) translateX(-10px); }
      50%{ transform: translateY(-6px) translateX(10px); }
      75%{ transform: translateY(-6px) translateX(-6px); }
    }
  </style>
</head>

<body>

  <!-- START -->
  <div id="startPane">
    <div class="startCard">
      <div class="title">èªå½™ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯</div>
      <p class="sub">30ç§’ã§ä½•å•æ­£è§£ã§ãã‚‹ã‹å‹è² ï¼<br>ï¼ˆå…ˆç”Ÿãƒ†ã‚¹ãƒˆé…å¸ƒãƒ¢ãƒ¼ãƒ‰ï¼šä»Šã¯ãƒ­ã‚°ã‚¤ãƒ³ç„¡ã—ã§ã‚‚éŠã¹ã¾ã™ï¼‰</p>
      <button id="startBtn" class="btn">â–¶ START</button>
      <div class="muted" style="margin-top:10px;">â€»iPhoneã¯å…±æœ‰â†’ã€Œãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã€</div>
    </div>
  </div>

  <!-- BATTLE -->
  <div id="battlePane" class="hidden">
    <div class="wrap">
      <div class="hud">
        <div class="stat">æ®‹ã‚Š <b id="timeLeft">30</b> ç§’</div>
        <div class="stat">ã‚¹ã‚³ã‚¢ <b id="scoreNow">0</b></div>
        <div class="stat">COMBO <b id="comboNow">0</b></div>
      </div>

      <div id="q"></div>
      <div id="choices"></div>

      <div class="row">
        <button id="stopBtn" class="btn2">çµ‚äº†</button>
      </div>
    </div>
  </div>

  <!-- RESULT -->
  <div id="resultPane" class="hidden">
    <div class="wrap">
      <div class="resultCard">
        <div class="resultBig">ğŸ‰ çµæœ</div>
        <div class="resultLine">ã‚¹ã‚³ã‚¢ï¼š<b id="finalScore">0</b> ç‚¹</div>
        <div class="resultLine">æœ€å¤§COMBOï¼š<b id="finalCombo">0</b></div>
      </div>

      <div class="row">
        <button id="retryBtn" class="btn">ã‚‚ã†ä¸€å›ï¼</button>
        <button id="goRankBtn" class="btn2">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’è¦‹ã‚‹</button>
      </div>

      <!-- Ranking -->
      <section id="rankingPane" class="card" style="margin-top:14px;">
        <div style="font-weight:900; font-size:18px;">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆå…ˆç”Ÿãƒ†ã‚¹ãƒˆç”¨ï¼šç«¯æœ«å†…ï¼‰</div>

        <div style="display:flex; gap:10px; align-items:center; margin:10px 0;">
          <label for="weekSelect">é€±ï¼š</label>
          <select id="weekSelect" style="flex:1; min-width:160px;"></select>
          <button id="rankRefreshBtn" class="btn2">æ›´æ–°</button>
        </div>

        <div class="card">
          <div style="font-weight:900;">é€±Top10ï¼ˆå€‹äººï¼‰</div>
          <div id="weeklyTop" class="muted" style="margin-top:6px;">ï¼ˆã¾ã ãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰</div>
        </div>

        <div class="card" style="margin-top:12px;">
          <div style="font-weight:900;">ã‚ãªãŸã®é †ä½</div>
          <div id="myRank" class="muted" style="margin-top:6px;">ï¼ˆã¾ã ãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰</div>
        </div>

        <div id="rankMsg" class="muted" style="margin-top:10px;"></div>
      </section>
    </div>
  </div>

  <!-- âœ… OVERLAYã¯å¿…ãš bodyç›´ä¸‹ã®æœ€å¾Œï¼ˆé‡è¦ï¼‰ -->
  <div id="overlay" class="hidden"><div class="panel"></div></div>

  <!-- JSï¼ˆé †ç•ªå³å®ˆï¼‰ -->
  <script src="./js/config.js"></script>
  <script src="./js/api.js"></script>
  <script src="./js/ranking.js"></script>
  <script src="./js/quiz.js"></script>
  <script src="./js/main.js"></script>

  <!-- SWç™»éŒ² -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>

</body>
</html>
