<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>語彙タイムアタック</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#0b1020">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- iPhone用 -->
  <link rel="apple-touch-icon" href="./icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <style>
    :root { --pad: 10px; }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      margin:0; padding:0; background:#000;
    }
    .hidden{ display:none !important; }

    /* START：写真背景 */
   #startPane {
  min-height: 100vh;

  background:
    linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)),
    url("./icons/start-bg.jpg?v=3") center / cover no-repeat;

  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;

  color: #ffffff;
  text-align: center;
}

    #startPane h1{
      margin:0 0 18px;
      font-size:34px;
      letter-spacing:.04em;
      text-shadow: 0 4px 16px rgba(0,0,0,.6);
    }
    #startBtn{
      font-size:22px;
      padding:16px 30px;
      border-radius:999px;
      border:none;
      background:#ff3b30;
      color:#fff;
      font-weight:900;
      box-shadow:0 10px 24px rgba(0,0,0,.35);
    }
    #startBtn:active{ transform:scale(.98); }

    /* BATTLE */
    #battlePane{
      min-height:100vh;
      background:#0b1020;
      color:#fff;
      padding: var(--pad);
    }
    .hud{
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:center;
      margin-bottom: 10px;
    }
    .stat{
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight: 800;
    }

    #q{
      margin-top: 10px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 12px;
    }
    #q h3{ margin:0 0 6px; font-size:24px; }

    /* 選択肢：2×2 */
    #choices{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top: 12px;
    }
    #choices button{
      font-size:18px;
      padding:18px 10px;
      border-radius:14px;
      border:none;
      background:#fff;
      color:#111;
      font-weight:900;
      min-height:78px;
      box-shadow:0 8px 20px rgba(0,0,0,.25);
    }
    #choices button:active{ transform:scale(.98); }

    /* ○×演出 */
    #bigMark{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      pointer-events:none;
      font-size:120px;
      font-weight:900;
      text-shadow:0 10px 40px rgba(0,0,0,.55);
      opacity:0;
      transform: scale(.9);
      transition: opacity .12s ease, transform .12s ease;
    }
    #bigMark.show{
      opacity:1;
      transform: scale(1);
    }
    #bigMark.ok{ color:#00e08a; }
    #bigMark.ng{ color:#ff3b30; }

    /* RESULT */
    #resultPane{
      min-height:100vh;
      background:#0b1020;
      color:#fff;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      padding: 18px 14px;
      text-align:center;
    }
    #resultSummary{
      width:min(520px, 100%);
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
    }
    #retryBtn{
      font-size:20px;
      padding:14px 26px;
      border-radius:999px;
      border:none;
      background:#2f6bff;
      color:#fff;
      font-weight:900;
    }
    /* ✅ ○×をスマホでも確実に見せる：画面中央の重ね表示 */
#effect {
  position: fixed;
  left: 50%;
  top: 44%;
  transform: translate(-50%, -50%);
  z-index: 9999;
  pointer-events: none;

  font-size: 96px;
  font-weight: 900;
  text-shadow: 0 10px 30px rgba(0,0,0,0.55);
  display: none; /* ←普段は消す */
}

#effect.show {
  display: block;
  animation: popfx 0.45s ease-out;
}

#effect.ok { color: #00c853; }   /* 緑 */
#effect.ng { color: #ff1744; }   /* 赤 */

@keyframes popfx {
  0%   { transform: translate(-50%, -50%) scale(0.4); opacity: 0; }
  70%  { transform: translate(-50%, -50%) scale(1.15); opacity: 1; }
  100% { transform: translate(-50%, -50%) scale(1.0); opacity: 1; }
}
/* ==== 派手演出：○×を画面中央に固定 ==== */
.fx {
  position: fixed;
  left: 50%;
  top: 42%;
  transform: translate(-50%, -50%);
  z-index: 9999;
  pointer-events: none;

  font-size: 120px;
  font-weight: 900;
  text-shadow: 0 14px 40px rgba(0,0,0,0.55);
  filter: drop-shadow(0 10px 18px rgba(0,0,0,0.35));
}

/* 色 */
.fx-ok { color: #00e676; }
.fx-ng { color: #ff1744; }

/* ポップ */
.fx-pop { animation: fxPop 0.46s cubic-bezier(.2,.9,.2,1); }
.fx-pop2 { animation: fxPop2 0.35s cubic-bezier(.2,.9,.2,1); }

/* シェイク */
.fx-shake { animation: fxShake 0.45s ease-in-out; }

@keyframes fxPop {
  0%   { transform: translate(-50%, -50%) scale(0.25) rotate(-10deg); opacity: 0; }
  70%  { transform: translate(-50%, -50%) scale(1.22) rotate(6deg); opacity: 1; }
  100% { transform: translate(-50%, -50%) scale(1.0) rotate(0deg); opacity: 1; }
}

@keyframes fxPop2 {
  0%   { transform: translate(-50%, -50%) scale(0.98); }
  60%  { transform: translate(-50%, -50%) scale(1.12); }
  100% { transform: translate(-50%, -50%) scale(1.0); }
}

@keyframes fxShake {
  0%   { transform: translate(-50%, -50%) scale(0.9) rotate(0deg); opacity: 0.2; }
  25%  { transform: translate(-52%, -50%) scale(1.05) rotate(-10deg); opacity: 1; }
  50%  { transform: translate(-48%, -50%) scale(1.05) rotate(10deg); }
  75%  { transform: translate(-51%, -50%) scale(1.02) rotate(-6deg); }
  100% { transform: translate(-50%, -50%) scale(1.0) rotate(0deg); }
}

/* ==== 背景フラッシュ ==== */
.bg-flash-ok { animation: bgFlashOk 0.14s ease-out; }
.bg-flash-ng { animation: bgFlashNg 0.16s ease-out; }

@keyframes bgFlashOk {
  0% { filter: brightness(1); }
  50% { filter: brightness(1.15) saturate(1.2); }
  100% { filter: brightness(1); }
}
@keyframes bgFlashNg {
  0% { filter: brightness(1); }
  40% { filter: brightness(0.9) saturate(1.25); }
  100% { filter: brightness(1); }
}

  </style>
</head>

<body>

  <!-- START -->
  <section id="startPane">
    <h1>語彙タイムアタック</h1>
    <button id="startBtn">▶ START</button>
    <div style="margin-top:10px; opacity:.85; font-size:12px;">
      30秒で何問正解できるか勝負！
    </div>
  </section>

  <!-- BATTLE -->
  <section id="battlePane" class="hidden">
    <div class="hud">
      <div class="stat">残り <span id="timeLeft">30</span>s</div>
      <div class="stat">SCORE <span id="scoreNow">0</span></div>
      <div class="stat">COMBO <span id="comboNow">0</span></div>
    </div>

    <div id="q"></div>
    <div id="choices"></div>

    <div style="margin-top:12px;">
      <button id="stopBtn" style="padding:10px 14px;border-radius:12px;border:none;font-weight:800;">
        終了
      </button>
    </div>
  </section>

  <!-- RESULT -->
  <section id="resultPane" class="hidden">
    <div id="resultSummary"></div>
    <button id="retryBtn">もう一回！</button>
  </section>

  <!-- ○× -->
  <div id="bigMark">○</div>

  <!-- JS -->
  <script src="./js/config.js"></script>
  <script src="./js/api.js"></script>
  <script src="./js/quiz.js"></script>
  <script src="./js/main.js"></script>

  <!-- SW -->
  <script>
  // ★更新が来たら「更新しますか？」を出してリロード
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("./sw.js").then((reg) => {
      reg.addEventListener("updatefound", () => {
        const nw = reg.installing;
        if (!nw) return;

        nw.addEventListener("statechange", () => {
          // 新SWが入った＆今のページが古いSW配下なら「更新あります」
          if (nw.state === "installed" && navigator.serviceWorker.controller) {
            const ok = confirm("新しいバージョンがあります。更新しますか？");
            if (ok) {
              // キャッシュの残りを掴みやすいので、強めにリロード
              location.reload(true);
            }
          }
        });
      });
    });
  }
</script>


</body>
</html>





